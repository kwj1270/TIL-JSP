기본 객체와 영역-2
=======================
# 4. application 기본 객체
웹 어플리케이션 안에는 여러 웹 페이지가 존재한다.      
```application 기본 객체```는 관련된 웹 페이지 '전체'에 해당하는 말로     
JSP 페이지는 ```application 기본 객체```를 공유하게 된다.    
    
```application 기본 객체```는 웹 어플리케이션 전반에 걸쳐서 사용되는 정보를 담고 있다.       
한 마디로 관련된 웹페이지가 공용으로 사용하는 정보를 담고 있다는 뜻이다.    
이로인해 초기 설정 정보를 읽어올 수 잇으며, 서버 정보 및 웹 어플리케이션이 제공하는 자원을 읽어올 수도 있다.    
  
## 4.1. 웹 어플리케이션 초기화 파라미터 읽어오기
기존에 우리가 파라미터를 사용하는 방법은  
웹 브라우저로 부터 넘어오는 '요청 정보'로부터 얻어서 활용을 해왔다.  
        
초기화 파라미터는 애초에 웹 어플리케이션 내에 정의되어 있는 파라미터라고 생각하면 되며     
이를 ```application 기본 객체```를 통해 조작 할 수 있다.      
앞서 말했듯이 웹 어플리케이션 내에 정의되어 있다는 것은 관련된 웹 페이지에서 공용으로 사용 가능하다.   
  
초기화 파라미터는 ```WEB-INF\``` **web.xml 파일** 에 ```<context-param> 태그```를 사용하여 추가한다.    
```  
<context-param>
  <description> 파라미터 설명(필수 아님) </description>
  <param-name> 파라미터이름 </param-name>
  <param-value> 파라미터이름 </param-value>
</context-param>
```
```web.xml 파일```에 초기화 파라미터를 추가하면,    
JSP는 ```application 기본 객체```가 제공하는 메소드를 사용해서 초기화 파라미터를 사용할 수 있다.       
```application 기본 객체```는 초기화 파라미터를 읽어올 수 있는 메소드를 제공한다.
```
getInitParameter(String name) | String              | 이름이 name인 초기화 파라미터의 값을 읽어온다.  
getInitParameterNames()       | Enumeration<String> | 웹 어플리케이션 초기화 파라미터의 이름 목록을 리턴한다.  
```
**예시**
```
<%@ page contentType="text/html; charset=utf-8" %>
<%@ page import="java.util.Enumeration" %>
<html>
<head><title>초기화 파라미터 읽어오기</title></head>
<body>
 
초기화 파라미터 목록 :
<ul>
<%
  Enumeration<String> initParamEnum = application.getInitParameterNames();
  while(initParamEnum.hasMoreElements()){
    String initParamName = iniParamEnum.nextElement();
%>
<li><%= initParamName %> =
  <%= application.getInitParameter(initParamName) %>
<%
}
%>
</ul>
</body>  
</html>    
```
위 코드는 헷갈리기 쉬우니 많이 봐두자  
처음에는 초기화 파라미터의 이름들을 ```initParamEnum```이 받아 왔다.  
```Enumeration<String> 데이터형```이기에 ```hasMoreElements()```로 내부에 저장된 값이 있는지 학인하고  
```nextElement();```으로 있으면 값을 반환하게끔 했다.  
```initParamName```은 그렇게 반환된 값(파라미터의 이름)을 받아서  
```<li> 와 </li>``` 사이에서 ```application.getInitParameter(initParamName)```로 파라미터의 값을 출력했다.  
   
      
웹 어플리케이션 초기화 파라미터는 웹 어플리케이션을 초기화하는데 필요한 설정 정보를 지정하기 위해 사용된다.    
주로 데이터베이스 연결과 관련된 설정 파일의 경로나,   
로깅 설정 파일 또는 웹 어플리케이션의 주요 속성 정보를 담고 있는 파일의 경로 등을 지정할 때 사용한다.  
   
## 4.2. 서버 정보 읽어오기
```application 기본 객체```는 현재 사용 중인 웹 컨테이너에 대한 정보를 읽어오는 메서드를 제공하고 있다.  
웹 컨테이너는 공부하고 있는 책을 기준으로 ```TOMCAT``` 을 의미한다고 보면 된다.  
```
getServerInfo()     | 서버 정보를 구한다
getMajorVersion()   | 서버가 지원하는 서블릿 규약의 메이저 버전을 리턴한다. (버전의 정수) 
getMinorVersion()   | 서버가 지원하는 서블릿 규약의 마이너 버전을 리턴한다. (버전의 실수)
```
```getServerInfo()```는 현재 사용하고 있는 웹 컨테이너의 정보를 반환한다.    
```getMajorVersion()```는 서블릿 버전의 정수 부분을 나타낸다    
```getMinorVersion()```는 서블릿 버전의 실수 부분을 나타낸다.    
  
**예시**
```
<%@ page contentType="text/html; charset=utf-8" %>
<html>
<head><title>서버 정보 출력</title></head>
<body>

서버정보: <%= application.getServerInfo() %> <br>
서블릿 규약 메이저 버전: <%= application.getMajorVersion() %> <br>
서블릿 규약 마이너 버전: <%= application.getMinorVersion() %> 

</body>
</html>
```
  
## 4.3. 로그 메시지 기록하기
```application 기본 객체```는 웹 컨테이너가 사용하는 로그 파일에 로그 메시지를 기록할 수 있도록 메서드를 제공한다.  
```
log(String msg)                     | void | msg를 로그로 남긴다.
log(String msg,Throwable throwable) | void | msg를 로그로 남긴다. 익셉션 정보도 함께 로그에 기록된다.  
```
```log()``` 메서드를 오버로딩 시켜서 두가지 기능으로 사용할 수 있게 했다.  
```log(String msg)``` 일반적인 로그 기록 방법이고  
```log(String msg,Throwable throwable)```는 에러가 발생했을 경우 에러까지 기록하는 방법이다.  
   
**예시**
```
일반)

<%@ page contentType="text/html; charset=utf-8" %>
<html>
<head><title>로그 메시지 기록</title></head>
<body>
<%
  application.log("로그 메시지 기록");
%>
로그 메시지를 기록합니다.  

</body>
</html>
__________________________________________________________
application 없이)

<%@ page contentType="text/html; charset=utf-8" %>
<html>
<head><title>로그 메시지 기록2</title></head>
<body>
<%
  log("로그 메시지 기록2");
%>
로그 메시지를 기록합니다.  

</body>
</html>
```
```log()```메서드는 ```application 기본 객체```에 포함된 메서드이기도 하지만  
JSP 내에서도 기본적으로 내장된 ```log()```메서드도 있다.  
그래서 ```application```을 붙이지 않으면 JSP의 ```log()```메서드를 사용하게 되는데  
결과는 거의 차이가 없다.  
약간의 차이점은 마지막에 ```jsp:``` 단어가 붙어있는 것 뿐이다.   
  
그러나 이것은 톰캣의 기준이고 각 컨테이너에 따라 형식이 다르니 반환되는 값이 다르다.  
또한 이는 ```application.log()```도 형식이 다르니 반환되는 값이 다르다는 것을 의미한다.
결론적으로 각 컨테이너에 따라 형식이 다르니 ```application.log()``` 나 ```log()``` 반환값이 다르다.   


## 4.4. 웹 어플리케이션의 자원 구하기
JSP 페이지에서 웹 
