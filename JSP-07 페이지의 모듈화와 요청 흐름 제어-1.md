페이지의 모듈화와 요청 흐름 제어-1
=======================
# 1. <jsp:include> 액션 태그를 이용한 공통 영역 작성
보통 하나의 웹 사이트를 구성하는 페이지들은 동일한 상단 메뉴, 좌측 메뉴 그리고 하단 푸터를 갖는다.  
이런 공통 구성 요소를 위한 코드를 모든 JSP 페이지마다 작성한다면 매우 번거롭고 코드 중복이 발생한다.  
게다가 공통 구성 요소의 일부를 수정한다면 모든 JSP 페이지를 수정해야 한다.  
이런 화면 구성요소의 코드 중복 문제를 없앨 때 사용할 수 있는 것이 바로 ```<jsp:include> 액션 태그```이다.   
```(손쉽게 생각해 우리가 함수를 사용하는 이유로 보면 된다. 이를 웹 페이지 형식으로 사용한다는 차이일 뿐이다.)```  

```<jsp:include> 액션 태그```는 위치한 부분에 지정한 페이지를 포함한다.  
[사진]  
  
위의 그림을 기준으로 ```<jsp:include> 액션 태그```의 처리 순서를 설명하자면  
  
1. main.jsp가 웹 브라우저의 요청을 받는다.
2. [출력 내용A]를 출력 버퍼에 저장한다.  
3. <jsp:include>가 실행되면 요청 흐름을 sub.jsp로 이동한다.  
4. [출력 내용 B]를 출력 버퍼에 저장한다.  
5. sub.jsp의 실행이 끝나면 요청 흐름이 다시 main.jsp의 <jsp:include>로 돌아온다.
6. <jsp:include> 이후 부분인 [출력 내용 C]를 출력 버퍼에 저장한다.  
7. 출력 버퍼의 내용을 응답 데이터로 전송한다.  
    
여기서 중요 포인트는 **요청 흐름의 변경** 과 **버퍼의 사용**이다.    
개인적으로 이전 장에서 배웠던 버퍼와 에러처리에 관해서 생각을 해보아야한다.  
  
## 1.1. <jsp:include> 액션 태그 사용법
**사용법**
```
<jsp:include page="경로" flush="true/false" /> 

경로는 웹 어플리케이션을 현재 디렉토리라는 기준으로 
```

* page : 포함할 JSP 페이지의 경로를 지정한다.
* flush : 지정한 JSP 페이지를 실행하기 전에 출력 버퍼를 플러시할지 여부를 지정  
          true 이면 출력 버퍼를 플러시하고 이동, false 이면 플러시 하지 않고 이동 기본값은 false 이다.    
            
출력 버퍼를 플러시 한다는 말은 앞선 내용들을 출력하고 이동한다는 말이다.  
다른 관점에서 보면 응답 코드와 응답 헤더를 먼저 보낸다는 의미로 해석되기도 한다.
  
우선적으로 응답 헤더의 입장에서 본다면 헤더를 보냈기 때문에      
이후에 ```response.setHeader()```와 같은 헤더 메서드를 실행해도 헤더가 추가되지 않느다.      
앞서 말했듯이 헤더를 전송하면 이후에는 추가/수정을 할 수 없다.     
    
버퍼와 응답코드 그리고 에러 처리 관점에서 보자면 응답 코드를 먼저 보냈기에
이후에 에러가 발생하면 먼저 출력된 페이지와 에러 페이지가 같이 출력되는 우려도 있고  
앞선 페이지의 오류가 없다면 응답 코드는 ```200```을 반환하기에 앞서 에러와 버퍼처리에 관한 문제가 발생한다.  

* **결론** : 후에 헤더의 값을 변경할 필요가 있던가    
              코드 전체적으로 완벽한 코드가 아니면 되도록이면 ```flush="false"```로 설정해두자.  
  
**예시**
```
<%@ page contentType="text/html; charset=utf-8" %>
<html>
<head><title></title></head>
<body>

main.jsp에서 생성한 내용.

<jsp:include page="sub.jsp" flush="false" />  <!-- <p>sub.jsp에서 생성한 내용.</p> -->

include의 이후의 내용.

</body>
</html>
```
```
main.jsp에서 생성한 내용.

sub.jsp에서 생성한 내용.

include의 이후의 내용.
```
```
<%@ page contentType="text/html; charset=utf-8" %>
<html>
<head><title></title></head>
<body>

main.jsp에서 생성한 내용.

<p>sub.jsp에서 생성한 내용.</p>

include의 이후의 내용.

</body>
</html>
```
### 1.1.1. 내용1
```
내용1
```
## 1.2. 소 주제
### 1.2.1. 내용1
```
내용1
```

***
# 2. 대주제
> 인용
## 2.1. 소 주제
### 2.1.1. 내용1
```
내용1
```   

***
# 3. 대주제
> 인용
## 3.1. 소 주제
### 3.1.1. 내용1
```
내용1
```
